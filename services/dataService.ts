import { CountryData, CentroidData } from '../types';

// Raw Data Strings (Embedded to ensure no external file dependency issues in the runtime)

const CENTROIDS_JSON = `{
  "US": [37.0902, -95.7129],
  "CA": [56.1304, -106.3468],
  "MX": [23.6345, -102.5528],
  "BR": [-14.2350, -51.9253],
  "AR": [-38.4161, -63.6167],
  "CL": [-35.6751, -71.5430],
  "GB": [55.3781, -3.4360],
  "FR": [46.2276, 2.2137],
  "DE": [51.1657, 10.4515],
  "ES": [40.4637, -3.7492],
  "IT": [41.8719, 12.5674],
  "NL": [52.1326, 5.2913],
  "BE": [50.5039, 4.4699],
  "SE": [60.1282, 18.6435],
  "NO": [60.4720, 8.4689],
  "FI": [61.9241, 25.7482],
  "PL": [51.9194, 19.1451],
  "TR": [38.9637, 35.2433],
  "IN": [20.5937, 78.9629],
  "CN": [35.8617, 104.1954],
  "JP": [36.2048, 138.2529],
  "KR": [35.9078, 127.7669],
  "AE": [23.4241, 53.8478],
  "SA": [23.8859, 45.0792],
  "AU": [-25.2744, 133.7751],
  "ZA": [-30.5595, 22.9375],
  "PT": [39.3999, -8.2245],
  "RU": [61.5240, 105.3188],
  "DK": [56.2639, 9.5018],
  "IE": [53.1424, -7.6921],
  "AT": [47.5162, 14.5501],
  "NZ": [-40.9006, 174.8860],
  "LT": [55.1694, 23.8813],
  "IS": [64.9631, -19.0208],
  "CH": [46.8182, 8.2275],
  "HU": [47.1625, 19.5033],
  "RO": [45.9432, 24.9668],
  "MY": [4.2105, 101.9758],
  "UA": [48.3794, 31.1656],
  "CZ": [49.8175, 15.4730],
  "EG": [26.8206, 30.8025],
  "ID": [-0.7893, 113.9213],
  "DO": [18.7357, -70.1627],
  "IL": [31.0461, 34.8516],
  "GR": [39.0742, 21.8243],
  "HR": [45.1000, 15.2000],
  "SK": [48.6690, 19.6990],
  "HK": [22.3193, 114.1694],
  "SI": [46.1512, 14.9955],
  "CR": [9.7489, -83.7534],
  "EE": [58.5953, 25.0136],
  "TW": [23.6978, 120.9605],
  "MA": [31.7917, -7.0926],
  "UY": [-32.5228, -55.7658],
  "RS": [44.0165, 21.0059],
  "AD": [42.5063, 1.5218],
  "CY": [35.1264, 33.4299],
  "LU": [49.8153, 6.1296],
  "JO": [30.5852, 36.2384],
  "LV": [56.8796, 24.6032],
  "CO": [4.5709, -74.2973],
  "BG": [42.7339, 25.4858],
  "IM": [54.2361, -4.5481],
  "LK": [7.8731, 80.7718],
  "GE": [42.3154, 43.3569],
  "MT": [35.9375, 14.3754],
  "PY": [-23.4425, -58.4438],
  "BA": [43.9159, 17.6791],
  "BY": [53.7098, 27.9534],
  "MC": [43.7384, 7.4246],
  "MD": [47.4116, 28.3699],
  "JM": [18.1096, -77.2975],
  "ME": [42.7087, 19.3744],
  "JE": [49.2144, -2.1313],
  "TH": [15.8700, 100.9925],
  "TN": [33.8869, 9.5375],
  "SM": [43.9424, 12.4578],
  "OM": [21.4735, 55.9754],
  "KH": [12.5657, 104.9910],
  "EC": [-1.8312, -78.1834],
  "PH": [12.8797, 121.7740],
  "AL": [41.1533, 20.1683],
  "XK": [42.6026, 20.9030],
  "GG": [49.4482, -2.5895],
  "MK": [41.6086, 21.7453],
  "KE": [-0.0236, 37.9062],
  "SG": [1.3521, 103.8198],
  "RE": [-21.1151, 55.5364],
  "LI": [47.1660, 9.5554],
  "PE": [-9.1900, -75.0152],
  "GI": [36.1408, -5.3536],
  "PA": [8.5380, -80.7821],
  "FO": [61.8926, -6.9118],
  "PR": [18.2208, -66.5901],
  "VN": [14.0583, 108.2772],
  "AM": [40.0691, 45.0382],
  "QA": [25.3548, 51.1839],
  "PK": [30.3753, 69.3451],
  "PS": [31.9522, 35.2332],
  "TT": [10.6918, -61.2225],
  "AX": [60.1785, 19.9156],
  "GH": [7.9465, -1.0232],
  "KZ": [48.0196, 66.9237],
  "AZ": [40.1431, 47.5769],
  "IQ": [33.2232, 43.6793],
  "RW": [-1.9403, 29.8739],
  "MO": [22.1987, 113.5439],
  "UG": [1.3733, 32.2903],
  "GT": [15.7835, -90.2308],
  "NP": [28.3949, 84.1240],
  "UZ": [41.3775, 64.5853],
  "AF": [33.9391, 67.7100],
  "KG": [41.2044, 74.7661],
  "ET": [9.1450, 40.4897],
  "BW": [-22.3285, 24.6849],
  "BH": [26.0667, 50.5577],
  "BB": [13.1939, -59.5432],
  "SZ": [-26.5225, 31.4659],
  "SJ": [77.5536, 23.6703]
}`;

const CSV_DATA = `country_code,stations,median_power_kw,fast_dc_share,unique_models,coverage_norm,capacity_norm,fastshare_norm,availability_norm,EIRI,gap_value,cluster,base,infra_heavy,availability_heavy
US,82138.0,3.7,0.1740850763349485,40.0,100.0,0.37,17.40850763349485,100.0,53.59270152669897,46.40729847330103,2,53.59270152669897,58.57420152669897,62.70377614502423
GB,26825.0,7.0,0.16544268406337373,0.0,32.65845284764664,0.7000000000000001,16.544268406337373,0.0,16.582234820326132,-16.582234820326132,0,16.582234820326132,19.813080105090798,14.087098757626931
DE,23373.0,22.0,0.13943439010824454,0.0,28.45576955854781,2.1999999999999997,13.943439010824454,0.0,14.830995625584016,-14.830995625584016,0,14.830995625584016,17.5665725814388,12.6010351971154
CA,16490.0,3.7,0.19921164342025469,5.0,20.07596970951326,0.37,19.92116434202547,12.5,13.375620752210398,-0.8756207522103985,0,13.375620752210398,14.739717723161723,13.23226404963346
ES,17825.0,22.0,0.35478260869565215,0.0,21.70128320631133,2.1999999999999997,35.47826086956521,0.0,16.436165456437575,-16.436165456437575,0,16.436165456437575,18.496293777068708,13.467188252643748
FR,13820.0,22.0,0.12973950795947903,0.0,16.825342715917117,2.1999999999999997,12.973950795947903,0.0,9.984927245556428,-9.984927245556428,0,9.984927245556428,11.55746151714814,8.384962569963175
IT,10354.0,22.0,0.22097740003863242,0.0,12.605614940709536,2.1999999999999997,22.097740003863244,0.0,10.121793977056464,-10.121793977056464,0,10.121793977056464,11.272355471127417,8.276626229827823
NL,8091.0,11.0,0.04375231738969225,0.0,9.850495507560447,1.0999999999999999,4.375231738969225,0.0,5.145244550818024,-5.145244550818024,0,5.145244550818024,6.07529410157407,4.37895818849154
SE,4953.0,22.0,0.24086412275388652,0.0,6.030095692614868,2.1999999999999997,24.086412275388653,0.0,7.889320732123678,-7.889320732123678,0,7.889320732123678,8.382330301385164,6.273495333723501
NO,4790.0,11.0,0.2939457202505219,0.0,5.8316491757773505,1.0999999999999999,29.39457202505219,0.0,8.541574075321378,-8.541574075321378,0,8.541574075321378,9.069738992899113,6.725263015279901
PT,3696.0,22.0,0.4734848484848485,0.0,4.499744332708369,2.1999999999999997,47.34848484848485,0.0,11.929594702780317,-11.929594702780317,0,11.929594702780317,12.269569136051155,9.227183243720656
RU,2203.0,60.0,0.6999546073536087,0.0,2.682071635540188,6.0,69.99546073536087,0.0,16.871920801288248,-16.871920801288248,3,16.871920801288248,16.840127964842267,12.938044182743196
DK,2178.0,22.0,0.13360881542699724,0.0,2.6516350532031456,2.1999999999999997,13.360881542699724,0.0,4.392830329821203,-4.392830329821203,0,4.392830329821203,4.547993835141518,3.4822045000260595
IE,2002.0,22.0,0.24075924075924077,0.0,2.4373615135503663,2.1999999999999997,24.07592407592408,0.0,6.450129420604963,-6.450129420604963,0,6.450129420604963,6.583865571959999,5.0144651411312395
FI,1873.0,22.0,0.19487453283502404,0.0,2.280308748691227,2.1999999999999997,19.487453283502404,0.0,5.469614156176972,-5.469614156176972,0,5.469614156176972,5.587645031046094,4.27122605456729
JP,1641.0,48.0,0.1956124314442413,4.0,1.9978572646034722,4.8,19.561243144424132,10.0,7.151391534726216,2.8486084652737844,0,7.151391534726216,6.611177261186563,7.333436514274835
TR,1278.0,45.0,0.4647887323943662,0.0,1.5559180890696145,4.5,46.478873239436616,0.0,11.26814188351517,-11.26814188351517,0,11.26814188351517,11.198733692422131,8.641402317089858
AT,1282.0,22.0,0.17628705148205928,0.0,1.5607879422435413,2.1999999999999997,17.628705148205928,0.0,4.8100562065386026,-4.8100562065386026,0,4.8100562065386026,4.856135000762956,3.7405815520161285
BE,1245.0,22.0,0.1285140562248996,0.0,1.5157418003847183,2.1999999999999997,12.851405622489958,0.0,3.8365778446518792,-3.8365778446518792,0,3.8365778446518792,3.878152024690351,3.008220473508145
AU,1241.0,50.0,0.5334407735697019,0.0,1.5108719472107917,5.0,53.34407735697019,0.0,12.773164250278356,-12.773164250278356,3,12.773164250278356,12.674251444999435,9.780416785069306
IN,1188.0,30.0,0.3779461279461279,0.0,1.4463463926562614,3.0,37.79461279461279,0.0,9.037461115985062,-9.037461115985062,0,9.037461115985062,9.032095755250689,6.925413156621609
NZ,978.0,25.0,0.36503067484662577,0.0,1.190679101025104,2.5,36.50306748466258,0.0,8.526885137342559,-8.526885137342559,0,8.526885137342559,8.520953047445069,6.517197808058173
LT,960.0,50.0,0.415625,0.0,1.1687647617424335,5.0,41.5625,0.0,10.280005904696974,-10.280005904696974,0,10.280005904696974,10.146882380871217,7.893442666609852
IS,432.0,22.0,0.30324074074074076,0.0,0.5259441427840951,2.1999999999999997,30.324074074074076,0.0,6.9351924719284535,-6.9351924719284535,0,6.9351924719284535,6.877786886206863,5.282691561085545
CH,878.0,22.0,0.2152619589977221,0.0,1.0689327716769341,2.1999999999999997,21.526195899772212,0.0,5.392812288625216,-5.392812288625216,0,5.392812288625216,5.38970556579291,4.1530558550527585
HU,864.0,22.0,0.22453703703703703,0.0,1.0518882855681901,2.1999999999999997,22.453703703703702,0.0,5.571496054968017,-5.571496054968017,0,5.571496054968017,5.566684883524836,4.286216455504421
RO,715.0,50.0,0.3902097902097902,0.0,0.8704862548394166,5.0,39.02097902097902,0.0,9.65239030613157,-9.65239030613157,0,9.65239030613157,9.489438931615513,7.407817042340648
BR,644.0,40.0,0.40217391304347827,0.0,0.7840463610022158,4.0,40.21739130434783,0.0,9.557096805270453,-9.557096805270453,0,9.557096805270453,9.435501441370674,7.307024922002949
MY,611.0,22.0,0.2978723404255319,0.0,0.7438700723173196,2.1999999999999997,29.78723404255319,0.0,6.9149948374375665,-6.9149948374375665,0,6.9149948374375665,6.8793818446692985,5.27843963169404
MX,579.0,18.0,0.0690846286701209,0.0,0.7049112469259051,1.7999999999999998,6.90846286701209,0.0,2.2036570721727804,-2.2036570721727804,0,2.2036570721727804,2.1841481968653707,1.73298836647588
UA,563.0,120.0,0.8916518650088809,0.0,0.6854318342301979,12.0,89.1651865008881,0.0,21.707210033869696,-21.707210033869696,3,21.707210033869696,21.17575321729272,16.614679117113784
CZ,555.0,22.0,0.29009009009009007,0.0,0.6756921278823443,2.1999999999999997,29.009009009009006,0.0,6.732078652954739,-6.732078652954739,0,6.732078652954739,6.689647865742973,5.137843596110171
PL,461.0,40.0,0.368763557483731,0.0,0.5612505782950644,4.0,36.8763557483731,0.0,8.799771380992647,-8.799771380992647,0,8.799771380992647,8.655896438822154,6.727891064659238
EG,457.0,22.0,0.23194748358862144,0.0,0.5563807251211376,2.1999999999999997,23.194748358862142,0.0,5.521501961820884,-5.521501961820884,0,5.521501961820884,5.4671400343329974,4.223945507621719
ID,412.0,30.0,0.4563106796116505,0.0,0.501594876914461,3.0,45.63106796116505,0.0,10.226851542998796,-10.226851542998796,0,10.226851542998796,10.127011030690241,7.7702184010948185
DO,368.0,7.0,0.19293478260869565,0.0,0.4480264920012662,0.7000000000000001,19.293478260869566,0.0,4.24790624897442,-4.24790624897442,0,4.24790624897442,4.257708898174546,3.2258310113308784
IL,295.0,90.0,0.9355932203389831,0.0,0.359151671577102,9.0,93.55932203389831,0.0,21.555525075410504,-21.555525075410504,3,21.555525075410504,21.141440242568216,16.409601390136732
GR,277.0,22.0,0.3140794223826715,0.0,0.3372373322944313,2.1999999999999997,31.40794223826715,0.0,7.076483380571203,-7.076483380571203,0,7.076483380571203,7.000207113800646,5.379224402043123
HR,267.0,50.0,0.5355805243445693,0.0,0.32506269935961435,5.0,53.558052434456926,0.0,12.341635566635231,-12.341635566635231,3,12.341635566635231,12.124141836571193,9.397479809944404
SK,253.0,22.0,0.35177865612648224,0.0,0.3080182132508705,2.1999999999999997,35.177865612648226,0.0,7.818780407829993,-7.818780407829993,0,7.818780407829993,7.73958222915508,5.934486216535038
HK,223.0,120.0,0.16591928251121077,0.0,0.27149431444641947,12.0,16.591928251121075,0.0,7.026983376002782,-7.026983376002782,0,7.026983376002782,6.454132807447425,5.583812247724408
SI,185.0,22.0,0.4,0.0,0.22523070929411476,2.1999999999999997,40.0,0.0,8.750092283717645,-8.750092283717645,0,8.750092283717645,8.662615354647057,6.62883074825294
CL,171.0,22.0,0.4093567251461988,0.0,0.20818622318537097,2.1999999999999997,40.93567251461988,0.0,8.930408992198124,-8.930408992198124,0,8.930408992198124,8.841227614516662,6.763216055307861
CR,171.0,7.7,0.36257309941520466,0.0,0.20818622318537097,0.77,36.25730994152047,0.0,7.565736477578242,-7.565736477578242,0,7.565736477578242,7.5480550998967795,5.7039616693429505
EE,169.0,50.0,0.9230769230769231,0.0,0.20575129659840757,5.0,92.3076923076923,0.0,20.043838980177828,-20.043838980177828,3,20.043838980177828,19.814414109837667,15.168166799963288
TW,162.0,250.0,0.9320987654320988,0.0,0.19722905354403564,25.0,93.20987654320987,0.0,26.22086693005959,-26.22086693005959,3,26.22086693005959,24.990589835413992,20.300511650221893
KR,161.0,250.0,1.0,0.0,0.19601159025055395,25.0,100.0,0.0,27.57840463610022,-27.57840463610022,3,27.57840463610022,26.348005795125278,21.318604056587695
ZA,159.0,50.0,0.6037735849056604,0.0,0.19357666366359055,5.0,60.37735849056604,0.0,13.652902363578644,-13.652902363578644,3,13.652902363578644,13.422260029945004,10.374355605867162
MA,151.0,22.0,0.44370860927152317,0.0,0.18383695731573693,2.1999999999999997,44.370860927152314,0.0,9.607706968356759,-9.607706968356759,0,9.607706968356759,9.516090664088331,7.269972074133355
UY,138.0,50.0,0.5434782608695652,0.0,0.1680099345004748,5.0,54.347826086956516,0.0,12.436769191191495,-12.436769191191495,3,12.436769191191495,12.203570184641542,9.460977390118643
AE,131.0,22.0,0.17557251908396945,0.0,0.15948769144610292,2.1999999999999997,17.557251908396946,0.0,4.235245458257831,-4.235245458257831,0,4.235245458257831,4.1411942274024405,3.239408478265678
RS,109.0,30.0,0.44036697247706424,0.0,0.13270349898950548,3.0,44.03669724770643,0.0,9.76042084913709,-9.76042084913709,0,9.76042084913709,9.62369119903604,7.4019508118022905
AD,96.0,22.0,0.0625,0.0,0.11687647617424335,2.1999999999999997,6.25,0.0,1.9567505904696971,-1.9567505904696971,0,1.9567505904696971,1.8584382380871216,1.528406766660985
CY,91.0,22.0,0.14285714285714285,0.0,0.11078915970683485,2.1999999999999997,14.285714285714285,0.0,3.561458521025591,-3.561458521025591,0,3.561458521025591,3.4625374369962745,2.731633348754535
LU,88.0,14.0,0.056818181818181816,0.0,0.10713676982638974,1.4000000000000001,5.681818181818182,0.0,1.5992183442941923,-1.5992183442941923,0,1.5992183442941923,1.5399320212768313,1.2397705967119637
JO,88.0,50.0,0.4318181818181818,0.0,0.10713676982638974,5.0,43.18181818181818,0.0,10.179218344294192,-10.179218344294192,0,10.179218344294192,9.939932021276832,7.764770596711963
LV,83.0,50.0,0.9397590361445783,0.0,0.10104945335898123,5.0,93.97590361445783,0.0,20.33560050423516,-20.33560050423516,3,20.33560050423516,20.09570544957106,15.381752850844318
CO,61.0,50.0,0.5245901639344263,0.0,0.07426526090238379,5.0,52.459016393442624,0.0,12.021509383049478,-12.021509383049478,3,12.021509383049478,11.778935909139717,9.144845300332229
BG,59.0,50.0,0.5084745762711864,0.0,0.0718303343154204,5.0,50.847457627118644,0.0,11.698223659149898,-11.698223659149898,3,11.698223659149898,11.455406692581441,8.902259261078193
IM,41.0,7.0,0.04878048780487805,0.0,0.04991599503274976,0.7000000000000001,4.878048780487805,0.0,1.2055761541106609,-1.2055761541106609,0,1.2055761541106609,1.1755677536139357,0.9241779153346331
LK,58.0,24.0,0.13793103448275862,0.0,0.07061287102193868,2.4,13.793103448275861,0.0,3.506865838063948,-3.506865838063948,0,3.506865838063948,3.393927125166142,2.6936800220990573
GE,50.0,22.0,0.18,0.0,0.06087316467408508,2.1999999999999997,18.0,0.0,4.2843492658696345,-4.2843492658696345,0,4.2843492658696345,4.180436582337043,3.2713056076359295
MT,55.0,11.0,0.0,0.0,0.06696048114149358,1.0999999999999999,0.0,0.0,0.35678419245659737,-0.35678419245659737,0,0.35678419245659737,0.30848024057074674,0.2984361683995227
PY,47.0,50.0,0.8936170212765957,0.0,0.05722077479363997,5.0,89.36170212765957,0.0,19.39522873544937,-19.39522873544937,3,19.39522873544937,19.150950812928734,14.67428259032671
BA,39.0,22.0,0.15384615384615385,0.0,0.04748106844578636,2.1999999999999997,15.384615384615385,0.0,3.7559155043013916,-3.7559155043013916,0,3.7559155043013916,3.65066361114597,2.874310681648333
BY,40.0,50.0,0.825,0.0,0.04869853173926806,5.0,82.5,0.0,18.019479412695706,-18.019479412695706,3,18.019479412695706,17.774349265869635,13.642044486108745
MC,37.0,84.8,0.02702702702702703,0.0,0.045046141858822955,8.48,2.7027027027027026,0.0,3.1025589972840697,-3.1025589972840697,0,3.1025589972840697,2.6830636114699518,2.5411715550559935
MD,34.0,50.0,0.6764705882352942,0.0,0.04139375197837785,5.0,67.64705882352942,0.0,15.045969265497234,-15.045969265497234,3,15.045969265497234,14.800108640695074,11.411546636721845
JM,33.0,7.0,0.3939393939393939,0.0,0.04017628868489615,0.7000000000000001,39.39393939393939,0.0,8.104858394261838,-8.104858394261838,0,8.104858394261838,8.073876023130326,6.098152610130622
ME,32.0,22.0,0.1875,18.0,0.03895882539141445,2.1999999999999997,18.75,45.0,8.925583530156565,36.074416469843435,0,8.925583530156565,6.569479412695707,14.626135588886996
JE,29.0,22.0,0.20689655172413793,0.0,0.03530643551096934,2.1999999999999997,20.689655172413794,0.0,4.812053608687147,-4.812053608687147,0,4.812053608687147,4.705584252238244,3.665805528290908
TH,28.0,50.0,0.9285714285714286,0.0,0.03408897221748764,5.0,92.85714285714286,0.0,20.085064160315568,-20.085064160315568,3,20.085064160315568,19.838473057537318,15.190502568847549
TN,25.0,22.0,0.36,0.0,0.03043658233704254,2.1999999999999997,36.0,0.0,7.872174632934817,-7.872174632934817,0,7.872174632934817,7.765218291168521,5.960652803817965
SM,25.0,22.0,0.0,0.0,0.03043658233704254,2.1999999999999997,0.0,0.0,0.6721746329348169,-0.6721746329348169,0,0.6721746329348169,0.5652182911685212,0.5606528038179648
AR,22.0,50.0,0.9545454545454546,0.0,0.026784192456597435,5.0,95.45454545454545,0.0,20.60162276789173,-20.60162276789173,3,20.60162276789173,20.354301187137388,15.577556285541627
OM,22.0,120.0,0.8636363636363636,0.0,0.026784192456597435,12.0,86.36363636363636,0.0,20.88344094970991,-20.88344094970991,3,20.88344094970991,20.28611936895557,15.963919921905262
KH,22.0,60.0,0.6818181818181818,0.0,0.026784192456597435,6.0,68.18181818181817,0.0,15.447077313346274,-15.447077313346274,3,15.447077313346274,15.149755732591935,11.736647194632534
EC,21.0,7.0,0.0,0.0,0.025566729163115733,0.7000000000000001,0.0,0.0,0.2202266916652463,-0.2202266916652463,0,0.2202266916652463,0.1877833645815579,0.18394835520709052
PH,16.0,22.1,0.4375,0.0,0.019479412695707226,2.21,43.75,0.0,9.420791765078283,-9.420791765078283,0,9.420791765078283,9.312239706347853,7.121817794443498
AL,15.0,120.0,0.6,0.0,0.018261949402225523,12.0,60.0,0.0,15.60730477976089,-15.60730477976089,3,15.60730477976089,15.009130974701112,12.00639168229078
XK,15.0,50.0,0.8,0.0,0.018261949402225523,5.0,80.0,0.0,17.50730477976089,-17.50730477976089,3,17.50730477976089,17.25913097470111,13.25639168229078
GG,15.0,7.0,0.0,0.0,0.018261949402225523,0.7000000000000001,0.0,0.0,0.21730477976089024,-0.21730477976089024,0,0.21730477976089024,0.18413097470111278,0.18139168229077896
MK,12.0,22.0,0.25,0.0,0.014609559521780419,2.1999999999999997,25.0,0.0,5.6658438238087125,-5.6658438238087125,0,5.6658438238087125,5.55730477976089,4.305113345832623
KE,12.0,22.0,0.0,0.0,0.014609559521780419,2.1999999999999997,0.0,0.0,0.6658438238087121,-0.6658438238087121,0,0.6658438238087121,0.5573047797608901,0.5551133458326231
CN,12.0,120.0,0.25,14.0,0.014609559521780419,12.0,25.0,35.0,12.105843823808712,22.894156176191288,0,12.105843823808712,9.75730477976089,15.505113345832623
SG,9.0,50.0,0.1111111111111111,0.0,0.010957169641335314,5.0,11.11111111111111,0.0,3.726605090078756,-3.726605090078756,0,3.726605090078756,3.47770080704289,2.920501676041134
RE,8.0,35.5,0.375,0.0,0.009739706347853613,3.55,37.5,0.0,8.568895882539142,-8.568895882539142,0,8.568895882539142,8.392369853173927,6.515908897221749
LI,8.0,22.0,0.125,0.0,0.009739706347853613,2.1999999999999997,12.5,0.0,3.1638958825391414,-3.1638958825391414,0,3.1638958825391414,3.0548698531739267,2.4284088972217486
PE,7.0,10.0,0.0,0.0,0.00852224305437191,1.0,0.0,0.0,0.30340889722174874,-0.30340889722174874,0,0.30340889722174874,0.25426112152718594,0.25298278506903016
GI,7.0,22.0,0.14285714285714285,0.0,0.00852224305437191,2.1999999999999997,14.285714285714285,0.0,3.5205517543646057,-3.5205517543646057,0,3.5205517543646057,3.411403978670043,2.6958399279261727
PA,6.0,26.0,0.3333333333333333,0.0,0.007304779760890209,2.6,33.33333333333333,0.0,7.4495885785710225,-7.4495885785710225,0,7.4495885785710225,7.3203190565471115,5.652556672916311
FO,5.0,50.0,0.8,0.0,0.0060873164674085075,5.0,80.0,0.0,17.502434926586965,-17.502434926586965,3,17.502434926586965,17.253043658233704,13.252130560763593
PR,4.0,39.5,0.25,0.0,0.0048698531739268065,3.95,25.0,0.0,6.186947941269571,-6.186947941269571,0,6.186947941269571,5.9899349265869635,4.739204448610875
VN,4.0,22.0,0.0,0.0,0.0048698531739268065,2.1999999999999997,0.0,0.0,0.6619479412695707,-0.6619479412695707,0,0.6619479412695707,0.5524349265869634,0.5517044486108743
AM,4.0,86.0,0.25,0.0,0.0048698531739268065,8.6,25.0,0.0,7.58194794126957,-7.58194794126957,0,7.58194794126957,7.152434926586963,5.901704448610874
QA,4.0,150.0,1.0,0.0,0.0048698531739268065,15.0,100.0,0.0,24.50194794126957,-24.50194794126957,3,24.50194794126957,23.752434926586965,18.751704448610873
PK,3.0,5.0,0.0,0.0,0.0036523898804451047,0.5,0.0,0.0,0.15146095595217804,-0.15146095595217804,0,0.15146095595217804,0.12682619494022254,0.12627833645815578
PS,3.0,22.0,0.3333333333333333,0.0,0.0036523898804451047,2.1999999999999997,33.33333333333333,0.0,7.328127622618844,-7.328127622618844,0,7.328127622618844,7.218492861606888,5.551278336458155
TT,3.0,11.0,0.3333333333333333,0.0,0.0036523898804451047,1.0999999999999999,33.33333333333333,0.0,6.998127622618844,-6.998127622618844,0,6.998127622618844,6.943492861606889,5.276278336458155
AX,3.0,50.0,0.6666666666666666,0.0,0.0036523898804451047,5.0,66.66666666666666,0.0,14.83479428928551,-14.83479428928551,3,14.83479428928551,14.585159528273554,11.251278336458155
GH,3.0,11.0,0.0,0.0,0.0036523898804451047,1.0999999999999999,0.0,0.0,0.331460955952178,-0.331460955952178,0,0.331460955952178,0.27682619494022254,0.27627833645815575
SA,3.0,22.0,0.0,0.0,0.0036523898804451047,2.1999999999999997,0.0,0.0,0.6614609559521779,-0.6614609559521779,0,0.6614609559521779,0.5518261949402224,0.5512783364581557
KZ,3.0,120.0,0.6666666666666666,0.0,0.0036523898804451047,12.0,66.66666666666666,0.0,16.93479428928551,-16.93479428928551,3,16.93479428928551,16.335159528273554,13.001278336458153
AZ,2.0,60.0,0.5,0.0,0.0024349265869634032,6.0,50.0,0.0,11.800973970634786,-11.800973970634786,3,11.800973970634786,11.501217463293482,9.000852224305437
IQ,2.0,73.3,0.5,0.0,0.0024349265869634032,7.33,50.0,0.0,12.199973970634785,-12.199973970634785,3,12.199973970634785,11.833717463293482,9.333352224305438
RW,2.0,50.0,1.0,0.0,0.0024349265869634032,5.0,100.0,0.0,21.500973970634785,-21.500973970634785,3,21.500973970634785,21.251217463293482,16.250852224305437
MO,2.0,120.0,1.0,0.0,0.0024349265869634032,12.0,100.0,0.0,23.600973970634787,-23.600973970634787,3,23.600973970634787,23.001217463293482,18.000852224305437
MM,1.0,1000.0,1.0,0.0,0.0012174632934817016,100.0,100.0,0.0,50.000486985317394,-50.000486985317394,1,50.000486985317394,45.000608731646736,40.000426112152724
UG,1.0,50.0,1.0,0.0,0.0012174632934817016,5.0,100.0,0.0,21.500486985317394,-21.500486985317394,3,21.500486985317394,21.25060873164674,16.25042611215272
GT,1.0,0.0,0.0,0.0,0.0012174632934817016,0.0,0.0,0.0,0.00048698531739268066,-0.00048698531739268066,0,0.00048698531739268066,0.0006087316467408508,0.00042611215271859556
NP,1.0,30.0,0.0,0.0,0.0012174632934817016,3.0,0.0,0.0,0.9004869853173926,-0.9004869853173926,0,0.9004869853173926,0.7506087316467408,0.7504261121527186
UZ,1.0,0.0,0.0,0.0,0.0012174632934817016,0.0,0.0,0.0,0.00048698531739268066,-0.00048698531739268066,0,0.00048698531739268066,0.0006087316467408508,0.00042611215271859556
AF,1.0,22.0,0.0,0.0,0.0012174632934817016,2.1999999999999997,0.0,0.0,0.6604869853173926,-0.6604869853173926,0,0.6604869853173926,0.5506087316467407,0.5504261121527185
KG,1.0,40.0,0.0,0.0,0.0012174632934817016,4.0,0.0,0.0,1.2004869853173927,-1.2004869853173927,0,1.2004869853173927,1.000608731646741,1.0004261121527187
ET,1.0,22.0,0.0,0.0,0.0012174632934817016,2.1999999999999997,0.0,0.0,0.6604869853173926,-0.6604869853173926,0,0.6604869853173926,0.5506087316467407,0.5504261121527185
NAN,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0,0.0,0.0,0.0
BW,1.0,22.0,0.0,0.0,0.0012174632934817016,2.1999999999999997,0.0,0.0,0.6604869853173926,-0.6604869853173926,0,0.6604869853173926,0.5506087316467407,0.5504261121527185
BH,1.0,22.0,0.0,0.0,0.0012174632934817016,2.1999999999999997,0.0,0.0,0.6604869853173926,-0.6604869853173926,0,0.6604869853173926,0.5506087316467407,0.5504261121527185
BB,1.0,0.0,0.0,0.0,0.0012174632934817016,0.0,0.0,0.0,0.00048698531739268066,-0.00048698531739268066,0,0.00048698531739268066,0.0006087316467408508,0.00042611215271859556
SZ,1.0,11.0,0.0,0.0,0.0012174632934817016,1.0999999999999999,0.0,0.0,0.3304869853173926,-0.3304869853173926,0,0.3304869853173926,0.2756087316467408,0.27542611215271856
LC,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0,0.0,0.0,0.0
SJ,1.0,0.0,0.0,0.0,0.0012174632934817016,0.0,0.0,0.0,0.00048698531739268066,-0.00048698531739268066,0,0.00048698531739268066,0.0006087316467408508,0.00042611215271859556`;

const COUNTRY_NAMES: Record<string, string> = {
  "US": "United States", "GB": "United Kingdom", "DE": "Germany", "CA": "Canada", "ES": "Spain",
  "FR": "France", "IT": "Italy", "NL": "Netherlands", "SE": "Sweden", "NO": "Norway",
  "PT": "Portugal", "RU": "Russia", "DK": "Denmark", "IE": "Ireland", "FI": "Finland",
  "JP": "Japan", "TR": "Turkey", "AT": "Austria", "BE": "Belgium", "AU": "Australia",
  "IN": "India", "NZ": "New Zealand", "LT": "Lithuania", "IS": "Iceland", "CH": "Switzerland",
  "HU": "Hungary", "RO": "Romania", "BR": "Brazil", "MY": "Malaysia", "MX": "Mexico",
  "UA": "Ukraine", "CZ": "Czech Republic", "PL": "Poland", "EG": "Egypt", "ID": "Indonesia",
  "DO": "Dominican Republic", "IL": "Israel", "GR": "Greece", "HR": "Croatia", "SK": "Slovakia",
  "HK": "Hong Kong", "SI": "Slovenia", "CL": "Chile", "CR": "Costa Rica", "EE": "Estonia",
  "TW": "Taiwan", "KR": "South Korea", "ZA": "South Africa", "MA": "Morocco", "UY": "Uruguay",
  "AE": "United Arab Emirates", "RS": "Serbia", "AD": "Andorra", "CY": "Cyprus", "LU": "Luxembourg",
  "JO": "Jordan", "LV": "Latvia", "CO": "Colombia", "BG": "Bulgaria", "IM": "Isle of Man",
  "LK": "Sri Lanka", "GE": "Georgia", "MT": "Malta", "PY": "Paraguay", "BA": "Bosnia and Herzegovina",
  "BY": "Belarus", "MC": "Monaco", "MD": "Moldova", "JM": "Jamaica", "ME": "Montenegro",
  "JE": "Jersey", "TH": "Thailand", "TN": "Tunisia", "SM": "San Marino", "AR": "Argentina",
  "OM": "Oman", "KH": "Cambodia", "EC": "Ecuador", "PH": "Philippines", "AL": "Albania",
  "XK": "Kosovo", "GG": "Guernsey", "MK": "North Macedonia", "KE": "Kenya", "CN": "China",
  "SG": "Singapore", "RE": "Réunion", "LI": "Liechtenstein", "PE": "Peru", "GI": "Gibraltar",
  "PA": "Panama", "FO": "Faroe Islands", "PR": "Puerto Rico", "VN": "Vietnam", "AM": "Armenia",
  "QA": "Qatar", "PK": "Pakistan", "PS": "Palestine", "TT": "Trinidad and Tobago", "AX": "Åland Islands",
  "GH": "Ghana", "SA": "Saudi Arabia", "KZ": "Kazakhstan", "AZ": "Azerbaijan", "IQ": "Iraq",
  "RW": "Rwanda", "MO": "Macao", "UG": "Uganda", "GT": "Guatemala", "NP": "Nepal", "UZ": "Uzbekistan",
  "AF": "Afghanistan", "KG": "Kyrgyzstan", "ET": "Ethiopia", "BW": "Botswana", "BH": "Bahrain",
  "BB": "Barbados", "SZ": "Eswatini", "LC": "Saint Lucia", "SJ": "Svalbard and Jan Mayen"
};

const parseCSV = (csv: string): any[] => {
  const lines = csv.trim().split(/\r?\n/);
  const headers = lines[0].split(',');
  return lines.slice(1).map(line => {
    // Basic CSV parsing that handles simple values.
    if (!line.trim()) return null;
    const values = line.split(',');
    const obj: any = {};
    headers.forEach((header, index) => {
      const val = values[index];
      if (val === undefined) return;
      if (!isNaN(Number(val)) && val.trim() !== '') {
          obj[header.trim()] = Number(val);
      } else {
          obj[header.trim()] = val.trim();
      }
    });
    return obj;
  }).filter(Boolean); // Filter out nulls
};

export const getEVData = (): CountryData[] => {
  const centroids: CentroidData = JSON.parse(CENTROIDS_JSON);
  const rawData = parseCSV(CSV_DATA);

  // Use Intl.DisplayNames for robust country name lookup if possible
  let regionNames: Intl.DisplayNames | null = null;
  try {
      regionNames = new Intl.DisplayNames(['en'], { type: 'region' });
  } catch (e) {
      console.warn("Intl.DisplayNames not supported", e);
  }

  // Filter and Transform
  return rawData
    .filter(row => row.country_code !== 'MM' && row.stations > 0 && row.EIRI !== undefined)
    .map((row) => {
      const coords = centroids[row.country_code];
      let countryName = COUNTRY_NAMES[row.country_code] || row.country_code;
      
      // Try to get a better name from Intl API
      if (regionNames) {
          try {
              const intlName = regionNames.of(row.country_code);
              if (intlName) countryName = intlName;
          } catch (e) {
              // Fallback to manual map or code if code is invalid (e.g. 'XK')
          }
      }

      return {
        ...row,
        country_name: countryName,
        gap_value: row.gap_value ?? (row.availability_norm - row.EIRI),
        lat: coords ? coords[0] : null,
        lng: coords ? coords[1] : null,
      } as CountryData;
    });
};
